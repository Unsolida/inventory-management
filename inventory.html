<!DOCTYPE html>
<html lang="km">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>á‘á˜áŸ’ášá„áŸ‹á”á‰áŸ’á…á¼á›áŸá˜áŸ’á—á¶ášáŸˆá‘áŸ†á“á·á‰</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Khmer OS Siemreap', 'Khmer OS Battambang', 'Khmer OS', Arial, sans-serif;
            background: #f5f5f5;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .header {
            background: #4a5568;
            color: white;
            padding: 20px 30px;
            border-radius: 8px 8px 0 0;
        }
        
        .header h1 {
            font-size: 24px;
        }
        
        .form-section {
            padding: 30px;
            border-bottom: 1px solid #e5e7eb;
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 6px;
            color: #374151;
            font-size: 14px;
            font-weight: 500;
        }
        
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #d1d5db;
            border-radius: 4px;
            font-size: 14px;
            font-family: inherit;
        }
        
        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #4a5568;
        }
        
        .btn {
            background: #4a5568;
            color: white;
            padding: 10px 24px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
        }
        
        .btn:hover {
            background: #2d3748;
        }
        
        .import-section {
            padding: 30px;
            background: #f9fafb;
            border-bottom: 1px solid #e5e7eb;
        }
        
        .import-section h2 {
            font-size: 18px;
            margin-bottom: 20px;
            color: #374151;
        }
        
        .import-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        
        .import-box {
            background: white;
            padding: 20px;
            border-radius: 6px;
            border: 1px solid #e5e7eb;
        }
        
        .import-box h3 {
            font-size: 16px;
            margin-bottom: 8px;
            color: #4a5568;
        }
        
        .import-box p {
            font-size: 13px;
            color: #6b7280;
            margin-bottom: 12px;
        }
        
        #pasteArea {
            width: 100%;
            margin-bottom: 12px;
            font-family: monospace;
            font-size: 12px;
            resize: vertical;
        }
        
        #fileStatus {
            margin-top: 10px;
            padding: 8px;
            border-radius: 4px;
            font-size: 13px;
        }
        
        #fileStatus.success {
            background: #d1fae5;
            color: #065f46;
        }
        
        #fileStatus.error {
            background: #fee2e2;
            color: #991b1b;
        }
        
        .table-section {
            padding: 30px;
            overflow-x: auto;
        }
        
        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .table-header h2 {
            font-size: 18px;
            color: #374151;
        }
        
        .action-buttons {
            display: flex;
            gap: 10px;
        }
        
        .btn-export {
            background: #059669;
        }
        
        .btn-export:hover {
            background: #047857;
        }
        
        .btn-clear {
            background: #dc2626;
        }
        
        .btn-clear:hover {
            background: #b91c1c;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            min-width: 1400px;
        }
        
        thead {
            background: #f9fafb;
        }
        
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e5e7eb;
            font-size: 13px;
        }
        
        th {
            color: #374151;
            font-weight: 600;
            white-space: nowrap;
        }
        
        tbody tr:hover {
            background: #f9fafb;
        }
        
        .btn-delete {
            background: #dc2626;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }
        
        .btn-delete:hover {
            background: #b91c1c;
        }
        
        .empty-state {
            text-align: center;
            padding: 40px;
            color: #9ca3af;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>á‘á˜áŸ’ášá„áŸ‹á”á‰áŸ’á…á¼á›áŸá˜áŸ’á—á¶ášáŸˆá‘áŸ†á“á·á‰</h1>
        </div>
        
        <div class="form-section">
            <form id="dataForm">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="invoiceNum">á›áŸáá”áŸááŸ’áá”á‰áŸ’á…á¼á›áŸá˜áŸ’á—á¶ášáŸˆ á‘áŸ†á“á·á‰ *</label>
                        <input type="text" id="invoiceNum" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="itemName">áˆáŸ’á˜áŸ„áŸ‡áŸá‰áŸ’á‰á¶ á€áŸ’á”á½á“ ááŸ’á“á¶á á”ášá·á€áŸ’áá¶áš á‘áŸ†á“á·á‰ *</label>
                        <input type="text" id="itemName" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="itemType">á”áŸ’ášá—áŸá‘áŸá˜áŸ’á—á¶ášáŸˆ á‘áŸ†á“á·á‰ *</label>
                        <select id="itemType" required>
                            <option value="">-- á‡áŸ’ášá¾áŸášá¾áŸ --</option>
                            <option value="áŸá˜áŸ’á—á¶ášáŸˆášáŸ€á“ á“á·á„á”á„áŸ’ášáŸ€á“">áŸá˜áŸ’á—á¶ášáŸˆášáŸ€á“ á“á·á„á”á„áŸ’ášáŸ€á“</option>
                            <option value="á€á·á…áŸ’á…áŠáŸ†áá¾ášá€á¶ášášáŠáŸ’á‹á”á¶á›">á€á·á…áŸ’á…áŠáŸ†áá¾ášá€á¶ášášáŠáŸ’á‹á”á¶á›</option>
                            <option value="á€á¶ášááŸ‚á‘á¶áŸ† á“á·á„á‡á½áŸá‡á»á›á•áŸ’áŸáŸá„áŸ—">á€á¶ášááŸ‚á‘á¶áŸ† á“á·á„á‡á½áŸá‡á»á›á•áŸ’áŸáŸá„áŸ—</option>
                            <option value="á€á¶ášá…á¼á›ášáŸ€á“áŠáŸ„á™áŸá˜á’á˜áŸŒá“á·á„á”á„áŸ’á€á¶ášáŸá·áŸáŸ’áŸá”áŸ„áŸ‡á”á„áŸ‹">á€á¶ášá…á¼á›ášáŸ€á“áŠáŸ„á™áŸá˜á’á˜áŸŒá“á·á„á”á„áŸ’á€á¶ášáŸá·áŸáŸ’áŸá”áŸ„áŸ‡á”á„áŸ‹</option>
                            <option value="á¢á”áŸ‹ášáŸ†á”áŸ†áá·á“á‡á¸áœá·á á€á¸á¡á¶ á€á¶ášá„á¶ášá™á»áœá‡á“ á“á·á„á€á»á˜á¶áš">á¢á”áŸ‹ášáŸ†á”áŸ†áá·á“á‡á¸áœá·á á€á¸á¡á¶ á€á¶ášá„á¶ášá™á»áœá‡á“ á“á·á„á€á»á˜á¶áš</option>
                            <option value="á€á¶ášá€áŸ‚á›á˜áŸ’á¢á”ášá·áŸáŸ’áá¶á“ á“á·á„á‘á¸á’áŸ’á›á¶á€á˜áŸ’áŸá¶á“áŸ’á">á€á¶ášá€áŸ‚á›á˜áŸ’á¢á”ášá·áŸáŸ’áá¶á“ á“á·á„á‘á¸á’áŸ’á›á¶á€á˜áŸ’áŸá¶á“áŸ’á</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="unit">á¯á€áá¶á‚á·á *</label>
                        <input type="text" id="unit" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="qtyDoc">á…áŸ†á“á½á“áá¶á˜áŸá€áŸ’áá¸á”ááŸ’áš *</label>
                        <input type="number" id="qtyDoc" required step="0.01">
                    </div>
                    
                    <div class="form-group">
                        <label for="qtyReceived">á”á‰áŸ’á…á¼á›á–á·áá”áŸ’ášá¶á€áŠ *</label>
                        <input type="number" id="qtyReceived" required step="0.01">
                    </div>
                    
                    <div class="form-group">
                        <label for="unitPrice">ááŸ’á›áŸƒá¯á€áá¶ *</label>
                        <input type="text" id="unitPrice" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="totalAmount">áŸášá»á”á‘á¹á€á”áŸ’ášá¶á€áŸ‹</label>
                        <input type="text" id="totalAmount" readonly>
                    </div>
                    
                    <div class="form-group">
                        <label for="entryDate">á€á¶á›á”ášá·á…áŸ’á†áŸá‘á”á‰áŸ’á‡á¸á”á‰áŸ’á…á¼á›áŸá˜áŸ’á—á¶ášáŸˆ á‘áŸ†á“á·á‰ *</label>
                        <input type="text" id="entryDate" required placeholder="DD/MMM/YYYY">
                    </div>
                    
                    <div class="form-group">
                        <label for="receivedFrom">á”á¶á“á‘á‘á½á›á–á¸/á¢áŸ’á“á€á•áŸ’á‚ááŸ‹á•áŸ’á‚á„áŸ‹ *</label>
                        <input type="text" id="receivedFrom" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="docType">áá¶á˜ (á”áŸ’ášá—áŸá‘áŸá€áŸ’áá¸á”ááŸ’ášáŠá¾á˜) *</label>
                        <select id="docType" required>
                            <option value="">-- á‡áŸ’ášá¾áŸášá¾áŸ --</option>
                            <option value="Invioce">Invioce</option>
                            <option value="á›á·áá·áá”á‰áŸ’á‡á¶á‘á·á‰">á›á·áá·áá”á‰áŸ’á‡á¶á‘á·á‰</option>
                            <option value="á”á„áŸ’á€á¶á“áŸ‹áŠáŸƒ">á”á„áŸ’á€á¶á“áŸ‹áŠáŸƒ</option>
                            <option value="á•áŸ’áŸáŸá„áŸ—">á•áŸ’áŸáŸá„áŸ—</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="docNum">á›áŸááŸá€áŸ’áá¸á”ááŸ’áš *</label>
                        <input type="text" id="docNum" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="invoiceDate">á€á¶á›á”ášá·á…áŸ’á†áŸá‘áœá·á€áŸ’á€á™á”ááŸ’áš *</label>
                        <input type="text" id="invoiceDate" required placeholder="DD/MMM/YYYY">
                    </div>
                    
                    <div class="form-group">
                        <label for="entryPerson">á¢áŸ’á“á€á”á‰áŸ’á…á¼á› *</label>
                        <input type="text" id="entryPerson" required>
                    </div>
                </div>
                
                <button type="submit" class="btn" style="margin-top: 20px;">á”á‰áŸ’á…á¼á›á‘á·á“áŸ’á“á“áŸá™</button>
            </form>
        </div>
        
        <div class="import-section">
            <h2>á“á¶áŸ†á…á¼á›á‘á·á“áŸ’á“á“áŸá™</h2>
            <div class="import-grid">
                <div class="import-box">
                    <h3>ğŸ“‚ á“á¶áŸ†á…á¼á›á–á¸á¯á€áŸá¶áš CSV</h3>
                    <p>á‡áŸ’ášá¾áŸášá¾áŸá¯á€áŸá¶áš CSV</p>
                    <input type="file" id="fileInput" accept=".csv" style="display: none;">
                    <button class="btn" onclick="document.getElementById('fileInput').click()">á‡áŸ’ášá¾áŸášá¾áŸá¯á€áŸá¶áš</button>
                    <div id="fileStatus"></div>
                </div>
                
                <div class="import-box">
                    <h3>ğŸ“‹ á”á·á‘á—áŸ’á‡á¶á”áŸ‹á‘á·á“áŸ’á“á“áŸá™á–á¸ Excel</h3>
                    <p>á…á˜áŸ’á›á„á‘á·á“áŸ’á“á“áŸá™á–á¸ Excel á á¾á™á”á·á‘á—áŸ’á‡á¶á”áŸ‹á‘á¸á“áŸáŸ‡</p>
                    <textarea id="pasteArea" placeholder="á”á·á‘á—áŸ’á‡á¶á”áŸ‹á‘á·á“áŸ’á“á“áŸá™á‘á¸á“áŸáŸ‡..." rows="4"></textarea>
                    <button class="btn" onclick="importFromPaste()">á“á¶áŸ†á…á¼á›á‘á·á“áŸ’á“á“áŸá™</button>
                </div>
                
                <div class="import-box">
                    <h3>ğŸ’¾ á‘á¶á‰á™á€á‘á˜áŸ’ášá„áŸ‹á‚áŸ†ášá¼</h3>
                    <p>á‘á¶á‰á™á€á¯á€áŸá¶ášá‚áŸ†ášá¼áŸá˜áŸ’ášá¶á”áŸ‹á”áŸ†á–áŸá‰á‘á·á“áŸ’á“á“áŸá™</p>
                    <button class="btn" onclick="downloadTemplate()">á‘á¶á‰á™á€á‚áŸ†ášá¼</button>
                </div>
            </div>
        </div>
        
        <div class="table-section">
            <div class="table-header">
                <h2>áá¶ášá¶á„á‘á·á“áŸ’á“á“áŸá™</h2>
                <div class="action-buttons">
                    <button class="btn btn-export" onclick="exportToExcel()">á“á¶áŸ†á…áŸá‰á‘áŸ… Excel</button>
                    <button class="btn btn-clear" onclick="clearAllData()">á›á»á”á‘á¶áŸ†á„á¢áŸáŸ‹</button>
                </div>
            </div>
            
            <div id="tableContainer"></div>
        </div>
    </div>

    <script>
        let dataStore = [];
        
        function parseKhmerNumber(str) {
            if (!str) return 0;
            return parseFloat(str.toString().replace(/[,áŸ›\s]/g, '')) || 0;
        }
        
        function formatKhmerCurrency(num) {
            return parseFloat(num).toLocaleString('en-US') + ' áŸ›';
        }
        
        document.getElementById('qtyReceived').addEventListener('input', calculateTotal);
        document.getElementById('unitPrice').addEventListener('input', calculateTotal);
        
        function calculateTotal() {
            const qty = parseFloat(document.getElementById('qtyReceived').value) || 0;
            const price = parseKhmerNumber(document.getElementById('unitPrice').value);
            document.getElementById('totalAmount').value = formatKhmerCurrency(qty * price);
        }
        
        function renderTable() {
            const container = document.getElementById('tableContainer');
            
            if (dataStore.length === 0) {
                container.innerHTML = '<div class="empty-state">á˜á·á“á‘á¶á“áŸ‹á˜á¶á“á‘á·á“áŸ’á“á“áŸá™</div>';
                return;
            }
            
            let html = `<table><thead><tr>
                <th>á›áŸáá”áŸááŸ’áá”á‰áŸ’á…á¼á›áŸá˜áŸ’á—á¶ášáŸˆ á‘áŸ†á“á·á‰</th>
                <th>áˆáŸ’á˜áŸ„áŸ‡áŸá‰áŸ’á‰á¶ á€áŸ’á”á½á“ ááŸ’á“á¶á á”ášá·á€áŸ’áá¶áš á‘áŸ†á“á·á‰</th>
                <th>á”áŸ’ášá—áŸá‘áŸá˜áŸ’á—á¶ášáŸˆ á‘áŸ†á“á·á‰</th>
                <th>á¯á€áá¶á‚á·á</th>
                <th>á…áŸ†á“á½á“áá¶á˜áŸá€áŸ’áá¸á”ááŸ’áš</th>
                <th>á”á‰áŸ’á…á¼á›á–á·áá”áŸ’ášá¶á€áŠ</th>
                <th>ááŸ’á›áŸƒá¯á€áá¶</th>
                <th>áŸášá»á”á‘á¹á€á”áŸ’ášá¶á€áŸ‹</th>
                <th>á€á¶á›á”ášá·á…áŸ’á†áŸá‘á”á‰áŸ’á‡á¸á”á‰áŸ’á…á¼á›áŸá˜áŸ’á—á¶ášáŸˆ á‘áŸ†á“á·á‰</th>
                <th>á”á¶á“á‘á‘á½á›á–á¸/á¢áŸ’á“á€á•áŸ’á‚ááŸ‹á•áŸ’á‚á„áŸ‹</th>
                <th>áá¶á˜ (á”áŸ’ášá—áŸá‘áŸá€áŸ’áá¸á”ááŸ’ášáŠá¾á˜)</th>
                <th>á›áŸááŸá€áŸ’áá¸á”ááŸ’áš</th>
                <th>á€á¶á›á”ášá·á…áŸ’á†áŸá‘áœá·á€áŸ’á€á™á”ááŸ’áš</th>
                <th>á¢áŸ’á“á€á”á‰áŸ’á…á¼á›</th>
                <th>áŸá€á˜áŸ’á˜á—á¶á–</th>
            </tr></thead><tbody>`;
            
            dataStore.forEach((e, i) => {
                html += `<tr>
                    <td>${e.invoiceNum}</td>
                    <td>${e.itemName}</td>
                    <td>${e.itemType}</td>
                    <td>${e.unit}</td>
                    <td>${e.qtyDoc}</td>
                    <td>${e.qtyReceived}</td>
                    <td>${e.unitPrice}</td>
                    <td>${e.totalAmount}</td>
                    <td>${e.entryDate}</td>
                    <td>${e.receivedFrom}</td>
                    <td>${e.docType}</td>
                    <td>${e.docNum}</td>
                    <td>${e.invoiceDate}</td>
                    <td>${e.entryPerson}</td>
                    <td><button class="btn-delete" onclick="deleteEntry(${i})">á›á»á”</button></td>
                </tr>`;
            });
            
            html += '</tbody></table>';
            container.innerHTML = html;
        }
        
        document.getElementById('dataForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            dataStore.push({
                invoiceNum: document.getElementById('invoiceNum').value,
                itemName: document.getElementById('itemName').value,
                itemType: document.getElementById('itemType').value,
                unit: document.getElementById('unit').value,
                qtyDoc: document.getElementById('qtyDoc').value,
                qtyReceived: document.getElementById('qtyReceived').value,
                unitPrice: document.getElementById('unitPrice').value,
                totalAmount: document.getElementById('totalAmount').value,
                entryDate: document.getElementById('entryDate').value,
                receivedFrom: document.getElementById('receivedFrom').value,
                docType: document.getElementById('docType').value,
                docNum: document.getElementById('docNum').value,
                invoiceDate: document.getElementById('invoiceDate').value,
                entryPerson: document.getElementById('entryPerson').value
            });
            
            renderTable();
            this.reset();
        });
        
        document.getElementById('fileInput').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (!file) return;
            
            const status = document.getElementById('fileStatus');
            const reader = new FileReader();
            
            reader.onload = function(event) {
                try {
                    const lines = event.target.result.split('\n').filter(l => l.trim());
                    for (let i = 1; i < lines.length; i++) {
                        const vals = lines[i].split(',').map(v => v.trim().replace(/^"|"$/g, ''));
                        if (vals.length >= 14) {
                            dataStore.push({
                                invoiceNum: vals[0], itemName: vals[1], itemType: vals[2],
                                unit: vals[3], qtyDoc: vals[4], qtyReceived: vals[5],
                                unitPrice: vals[6], totalAmount: vals[7], entryDate: vals[8],
                                receivedFrom: vals[9], docType: vals[10], docNum: vals[11],
                                invoiceDate: vals[12], entryPerson: vals[13]
                            });
                        }
                    }
                    renderTable();
                    status.className = 'success';
                    status.textContent = 'âœ“ á“á¶áŸ†á…á¼á›á‡áŸ„á‚á‡áŸá™';
                } catch (error) {
                    status.className = 'error';
                    status.textContent = 'âœ— á€áŸ†á á»áŸ';
                }
            };
            reader.readAsText(file);
        });
        
        function importFromPaste() {
            const text = document.getElementById('pasteArea').value.trim();
            if (!text) return alert('áŸá¼á˜á”á·á‘á—áŸ’á‡á¶á”áŸ‹á‘á·á“áŸ’á“á“áŸá™');
            
            const lines = text.split('\n').filter(l => l.trim());
            let count = 0;
            
            lines.forEach(line => {
                const vals = line.split('\t');
                if (vals.length >= 15 && vals[0] !== 'á›.áš') {
                    dataStore.push({
                        invoiceNum: vals[1], itemName: vals[2], itemType: vals[3],
                        unit: vals[4], qtyDoc: vals[5], qtyReceived: vals[6],
                        unitPrice: vals[7], totalAmount: vals[8], entryDate: vals[9],
                        receivedFrom: vals[10], docType: vals[11], docNum: vals[12],
                        invoiceDate: vals[13], entryPerson: vals[14]
                    });
                    count++;
                }
            });
            
            renderTable();
            document.getElementById('pasteArea').value = '';
            alert(`âœ“ á“á¶áŸ†á…á¼á›á‡áŸ„á‚á‡áŸá™ ${count} á‡á½áš`);
        }
        
        function downloadTemplate() {
            const csv = 'á›áŸáá”áŸááŸ’áá”á‰áŸ’á…á¼á›áŸá˜áŸ’á—á¶ášáŸˆ á‘áŸ†á“á·á‰,áˆáŸ’á˜áŸ„áŸ‡áŸá‰áŸ’á‰á¶ á€áŸ’á”á½á“ ááŸ’á“á¶á á”ášá·á€áŸ’áá¶áš á‘áŸ†á“á·á‰,á”áŸ’ášá—áŸá‘áŸá˜áŸ’á—á¶ášáŸˆ á‘áŸ†á“á·á‰,á¯á€áá¶á‚á·á,á…áŸ†á“á½á“áá¶á˜áŸá€áŸ’áá¸á”ááŸ’áš,á”á‰áŸ’á…á¼á›á–á·áá”áŸ’ášá¶á€áŠ,ááŸ’á›áŸƒá¯á€áá¶,áŸášá»á”á‘á¹á€á”áŸ’ášá¶á€áŸ‹,á€á¶á›á”ášá·á…áŸ’á†áŸá‘á”á‰áŸ’á‡á¸á”á‰áŸ’á…á¼á›áŸá˜áŸ’á—á¶ášáŸˆ á‘áŸ†á“á·á‰,á”á¶á“á‘á‘á½á›á–á¸/á¢áŸ’á“á€á•áŸ’á‚ááŸ‹á•áŸ’á‚á„áŸ‹,áá¶á˜ (á”áŸ’ášá—áŸá‘áŸá€áŸ’áá¸á”ááŸ’ášáŠá¾á˜),á›áŸááŸá€áŸ’áá¸á”ááŸ’áš,á€á¶á›á”ášá·á…áŸ’á†áŸá‘áœá·á€áŸ’á€á™á”ááŸ’áš,á¢áŸ’á“á€á”á‰áŸ’á…á¼á›\n001,á€á¶áœá”á·áááŸ’á›á¶ áŸ¥áŸ á˜á›,áŸá˜áŸ’á—á¶ášáŸˆášáŸ€á“ á“á·á„á”á„áŸ’ášáŸ€á“,áŠá”,10,10,"5,000 áŸ›","50,000 áŸ›",11/Mar/2025,á”ááŸ’áá¶á‚á¶ á—áŸ’á“áŸ†áŸáŸ’ášá»á€ á›á€áŸ‹áŸá˜áŸ’á—á¶ášáŸˆá€á¶ášá·á™á¶á›áŸá™,Invioce,00032,10/Mar/2025,áŸáŸ’áœá¶á„ á˜á“áŸ„ášá˜áŸ’á™';
            const blob = new Blob(['\uFEFF' + csv], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'template.csv';
            link.click();
        }
        
        function exportToExcel() {
            if (dataStore.length === 0) return alert('á˜á·á“á˜á¶á“á‘á·á“áŸ’á“á“áŸá™');
            
            let csv = 'á›áŸáá”áŸááŸ’áá”á‰áŸ’á…á¼á›áŸá˜áŸ’á—á¶ášáŸˆ á‘áŸ†á“á·á‰,áˆáŸ’á˜áŸ„áŸ‡áŸá‰áŸ’á‰á¶ á€áŸ’á”á½á“ ááŸ’á“á¶á á”ášá·á€áŸ’áá¶áš á‘áŸ†á“á·á‰,á”áŸ’ášá—áŸá‘áŸá˜áŸ’á—á¶ášáŸˆ á‘áŸ†á“á·á‰,á¯á€áá¶á‚á·á,á…áŸ†á“á½á“áá¶á˜áŸá€áŸ’áá¸á”ááŸ’áš,á”á‰áŸ’á…á¼á›á–á·áá”áŸ’ášá¶á€áŠ,ááŸ’á›áŸƒá¯á€áá¶,áŸášá»á”á‘á¹á€á”áŸ’ášá¶á€áŸ‹,á€á¶á›á”ášá·á…áŸ’á†áŸá‘á”á‰áŸ’á‡á¸á”á‰áŸ’á…á¼á›áŸá˜áŸ’á—á¶ášáŸˆ á‘áŸ†á“á·á‰,á”á¶á“á‘á‘á½á›á–á¸/á¢áŸ’á“á€á•áŸ’á‚ááŸ‹á•áŸ’á‚á„áŸ‹,áá¶á˜ (á”áŸ’ášá—áŸá‘áŸá€áŸ’áá¸á”ááŸ’ášáŠá¾á˜),á›áŸááŸá€áŸ’áá¸á”ááŸ’áš,á€á¶á›á”ášá·á…áŸ’á†áŸá‘áœá·á€áŸ’á€á™á”ááŸ’áš,á¢áŸ’á“á€á”á‰áŸ’á…á¼á›\n';
            
            dataStore.forEach((e) => {
                csv += `"${e.invoiceNum}","${e.itemName}","${e.itemType}","${e.unit}","${e.qtyDoc}","${e.qtyReceived}","${e.unitPrice}","${e.totalAmount}","${e.entryDate}","${e.receivedFrom}","${e.docType}","${e.docNum}","${e.invoiceDate}","${e.entryPerson}"\n`;
            });
            
            const blob = new Blob(['\uFEFF' + csv], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `data_${new Date().toISOString().split('T')[0]}.csv`;
            link.click();
        }
        
        function deleteEntry(i) {
            if (confirm('áá¾á¢áŸ’á“á€á”áŸ’ášá¶á€áŠáá¶á…á„áŸ‹á›á»á”á‘áŸ?')) {
                dataStore.splice(i, 1);
                renderTable();
            }
        }
        
        function clearAllData() {
            if (confirm('áá¾á¢áŸ’á“á€á”áŸ’ášá¶á€áŠáá¶á…á„áŸ‹á›á»á”á‘á¶áŸ†á„á¢áŸáŸ‹á‘áŸ?')) {
                dataStore = [];
                renderTable();
            }
        }
        
        renderTable();
    </script>
</body>
</html>